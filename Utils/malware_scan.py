import requests
from config import VIRUSTOTAL_API_KEY


def scan_file_virustotal(file_path):
    """Scan a file using VirusTotal API."""
    url = "https://www.virustotal.com/api/v3/files"
    headers = {"x-apikey": VIRUSTOTAL_API_KEY}

    try:
        with open(file_path, "rb") as file:
            files = {"file": file}
            response = requests.post(url, headers=headers, files=files)

        if response.status_code == 200:
            result = response.json()
            scan_id = result.get("data", {}).get("id", "Unknown ID")
            return f"File submitted for scanning. Scan ID: {scan_id}"
        else:
            return f"Error scanning file: {response.json()}"

    except Exception as e:
        return f"Error connecting to VirusTotal: {e}"








